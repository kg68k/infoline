
    infoline


━☆ 始めに ☆━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

　infoline はファンクションキー表示行に、各種の情報をほぼリアルタイムに
表示する常駐プログラムです。

　通常、画面の最下行にはファンクションキーに設定されている文字列の内容(
または任意のラベル)が表示されています。これは、ファンクションキーを使わ
ない場合は無意味であるばかりでなく、ディスプレイに焼き付きを起こす原因と
なっています。人によってはファンクションキーの表示をしないように設定して
いることでしょう。

　そこで、ファンクションキーを表示するかわりに、常時表示されていると便利
な情報を表示するツール『infoline』を作り、最下行を有効利用するようにしま
した。


━☆ 使用法 ☆━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

　実行すると常駐し、以後情報を表示を行います。-r、--release オプションを
指定して実行すると常駐を解除します。

　-a オプションを指定すると Timer-A 割り込みを使用します。その場合でも
RTC 割り込みも併用します。EX68 で使用する場合はこのオプションを指定して
下さい。常駐時以外に指定しても無視されます。

　-c<n> オプションで表示色(属性)を変更できます。<n> には 1～15 の数値を
指定して下さい。デフォルトは 2 です。

　-n オプションを指定するとファンクションキー行を再描画しません。一時的
に機能をオフにして画面全体を書き換えるアプリケーションを起動する場合など、
再描画すると欝陶しい場合に指定して下さい。

　-q オプションを指定すると一切のメッセージ出力を行いません。

　off コマンドを指定すると常駐したまま、表示を行わないようになります。on
コマンドを指定すると表示が再び行われるようになります。

　常駐時にオプションなしで実行した場合、MFP 及び RTC の再設定を行います。
なんらかの理由で動作が停止してしまった場合などは、一度実行してみて下さい。


例:
    infoline -c3        # 表示色 3 で常駐
    infoline -r         # 常駐解除

    infoline -nq off; dedit; infoline -q on
        # 一時的に機能停止してから dedit を実行する


━☆ 機能 ☆━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

　以下の情報が左側から順番に表示されます。左端の二桁分は condrv(em).sys
のステータス表示用に空けてあります。

・プロセス終了コード

    　直前に実行したプログラムの終了コードが一桁または四桁で表示されます
    (値が $f より大きい場合は四桁表示)。

    表示例:
        $0              # 終了コード 0

・MPU の種類とクロック周波数

    　MPU の種類(68000～68060)と、動作クロックを二桁又は三桁で表示します。
    MMU/FPU の有無は表示しません。

    表示例:
        mpu:68060(50MHz)        # MPU=68060 動作クロック=50MHz
        mpu:68000@120MHz        # MPU=68000 動作クロック=120MHz

・キャッシュ状態

    　VENUS-X の二次キャッシュ及び MPU の内蔵データ/命令キャッシュの状態
    を表示します。それぞれのキャッシュが 'V'、'D'、'I' で表わされ、キャ
    ッシュがオンの場合は大文字で、オフの場合は小文字で表示されます。キャ
    ッシュが実装されていない場合は '_' になります。

    表示例:
        cache:_DI               # データ/命令キャッシュオン

・割り込み使用状況

    　MFP が管理する割り込みのうち八種類について、割り込みが許可されてい
    るか否かを表示します。以下の一覧にある文字が表示されていれば割り込み
    許可、'_' になっていれば割り込み禁止を表わします。

        A   Timer-A
        B   Timer-B
        C   Timer-C
        D   Timer-D
        H   H-SYNC
        O   OPM
        R   Raster(CRTC-IRQ)
        V   V-DISP

    　なお表示はされませんが、RTC アラーム割り込みは基本的に常時割り込み
    許可状態になっています。

    表示例:
        int:__CD____            # Timer-C/D のみ割り込み許可

・(V)TwentyOne.sys の設定

    　(V)TwentyOne.sys の各オプションについて、オンかオフかを表示します。
    以下の一覧にある文字が表示されていればオン(+X)、'_' になっていればオ
    フ(-X)を表わします。

        C   (+C) 大文字小文字を区別する
        S   (+S) 特殊な文字を使用可能にする
        P   (+P) ピリオドを複数使用使用可能にする
        T   (+T) ファイル名を 21 文字認識する
        F   (+F) 読み込み専用ファイルをアーカイブ属性と見なす
        R   (+R) '/'を SYSROOT に展開する
        W   (+W) 大文字小文字不一致を警告する
        Y   (+Y) '\'を SYSROOT に展開する
        A   (+A) VFAT は短縮名を返す

    　TwentyOne.x 及び VTwentyOne.x には対応していません。

    表示例:
        twon:CSPT_R___          # +csptr -fwya

・PCM8 の常駐状態

    　PCM8 もしくは互換ドライバの動作モードを表示します。

        off     多重再生禁止
        on      多重再生許可
        fnc     専用ファンクションコールのみ多重再生許可
        ___     PCM8 は常駐していない

    表示例:
        pcm8:fnc                # pcm8 fnc

・年月日(曜日)

    　年月日及び曜日を表示します。

    表示例:
        2023-06-03(土)

・時刻

    　時刻を表示します。

    表示例:
        01:58:32


━☆ 仕様 ☆━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

　infoline は RTC のアラーム割り込みを 16Hz モードで使用しています。動作
中に同割り込みを使用するアプリケーションを実行した場合、終了して割り込み
が解放されても infoline の動作が再開されないことがあります。そのような時
は一度 infoline を実行してみて下さい。動作が再開されます。

　動作中は常時テキスト画面を書き換えています。ファンクションキー行を消す
のに DOS コールで設定を変更する代わりに TVRAM を塗りつぶすだけですまして
いるようなアプリケーションでは、時刻など一部だけの表示が更新されてしまい
ます。

　-a オプション指定時は Timer-A を 4 分周、表示帰線期間割り込みで使用し
ます。既に他のソフトウェアで使用されている場合でも強制的に使用し、また常
駐解除後はベクタは戻しますが、割り込み設定は戻しません。常駐後にオプショ
ンなしで infoline を実行した場合でも、Timer-A の再設定は行いません。


━☆ 不具合 ☆━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

　表示ルーチンに手を抜いてハードウェア割り込み内から IOCS コールを使用し
ているせいで、テキストのラスタコピーを行うアプリケーションと相性が悪い
(ラスタコピーが化ける)ことがあります。エラー処理の白帯が出た時に表示が乱
れることがあるかも知れません。

　理由は不明ですが、常駐しているとオフ状態でも同人ゲームの『ねぴあらんど』
でスプライトが表示されません。


━☆ 著作権 ☆━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

　著作権の扱いや配布規定は GNU GENERAL PUBLIC LICENSE Version 3 かそれ以
降の任意の版に従います。当然無保証です。


━☆ 連絡先 ☆━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

TcbnErik
  https://github.com/kg68k/infoline


[EOF]
